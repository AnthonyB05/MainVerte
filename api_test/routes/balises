const express = require('express')
const router = express.Router();
const balisesJson = require('../../balises.json');
const Balise = require('../model/balise');
const mongoose = require('mongoose')
const verifyToken = require('../../verifyToken');




router.get('/', verifyToken, (req,res,next) => {  
     Balise.find()
     .then(result=>{
        res.status(200).json({
            balises:result
        }

        )
     })})
    // res.status(200).json(balisesJson)})
router.get('/:id',verifyToken,(req,res,next) => { 
    console.log(req.params.id)
    Balise.find({id: req.params.id})
    .then(result=>{
        res.status(200).json({
            balise:result
        })
    })
    .catch(err=>{
        console.log(err);
        res.status(500).json({
            error:err
        })
    })
})
       
router.post('/',verifyToken,(req,res,next)=>{
   const uneBalise = new Balise({
    id: req.body.id,
    nameBalise: req.body.nameBalise
   })
   console.log(req.body)
   uneBalise.save()
   .then(result=>{
    console.log(result);
    res.status(200).json({
        newBalise:result
    })
   })
   .catch(err=>{
    console.log(err);
    res.status(500).json({
        error:err
    });
   })
})
function getBalise(id) {
    return persons.find(p => p.id === +id);
}
module.exports = router;